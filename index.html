<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Glass Cards</title>

<style>
:root {
  --bg: #000;
  --text: #fff;
  --line: rgba(255,255,255,.22);
  --line2: rgba(255,255,255,.42);
  --glass: rgba(0,0,0,.55);
  --radius: 18px;
  --shadow: 0 10px 30px rgba(0,0,0,.55);
}

* { box-sizing: border-box; }
body {
  margin:0;
  font-family: system-ui;
  background:#000;
  color:white;
}

.wrap { max-width:1200px; margin:auto; padding:20px; }

.card {
  background:rgba(255,255,255,.05);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:20px;
  backdrop-filter:blur(10px);
  box-shadow:var(--shadow);
}

.grid { display:grid; gap:32px; }
@media(min-width:900px){
  .grid { grid-template-columns:repeat(2,1fr); }
}

.card-item {
  position:relative;
  padding:16px;
  border-radius:var(--radius);
  background:var(--glass);
  border:1px solid var(--line);
  cursor:pointer;
  transition:.2s;
}
.card-item:hover { transform:translateY(-2px); }

.name { font-weight:800; font-size:14px; }
.meta { font-size:11px; opacity:.7; }

.half-wrapper { display:flex; gap:24px; flex-wrap:wrap; }

.card-item {
  margin-bottom: 20px;
}
.card-item.half { flex:1 1 calc(50% - 8px); }

/* Edit Button */
.edit-btn{
  position:absolute;
  top:8px;
  right:8px;
  width:22px;
  height:22px;
  border-radius:50%;
  border:1px solid white;
  cursor:pointer;
}

/* View Modal */
.modal, .editor-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  display:flex;
  justify-content:center;
  align-items:center;
  opacity:0;
  pointer-events:none;
  transition:.2s;
}
.modal.active, .editor-modal.active{
  opacity:1;
  pointer-events:auto;
}

.modal-content, .editor-content{
  background:#111;
  padding:24px;
  border-radius:16px;
  width:400px;
  max-width:95%;
  display:flex;
  flex-direction:column;
  gap:12px;
}

input, select{
  padding:6px;
  background:#222;
  border:1px solid #444;
  color:white;
  border-radius:6px;
}
button{
  padding:8px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="wrap">

<div class="grid">

<div class="card">
<h2>Panel 1</h2>

<div class="card-item full" data-detail="Full card popup.">
<p class="name">Full Card One</p>
<p class="meta">Detailed info</p>
</div>

<div class="half-wrapper">
<div class="card-item half" data-detail="Half A popup">
<p class="name">Half Card A</p>
<p class="meta">Snippet</p>
</div>

<div class="card-item half" data-detail="Half B popup">
<p class="name">Half Card B</p>
<p class="meta">Snippet</p>
</div>
</div>
<button id="addCardBtn">+ Add Card</button>
</div>

</div>
</div>

<!-- View Modal -->
<div class="modal" id="modal">
<div class="modal-content">
<p id="modal-text"></p>
<button id="closeModal">Close</button>
</div>
</div>

<!-- Editor Modal -->
<div class="editor-modal" id="editorModal">
<div class="editor-content">
<label>Text</label>
<input type="text" id="editText">

<label>Text Color</label>
<input type="color" id="editTextColor">

<label>Text Size</label>
<input type="number" id="editTextSize" min="10" max="60">

<label>Box Color</label>
<input type="color" id="editBoxColor">

<label>Gradient</label>
<select id="gradientSelect">
<option value="none">None</option>
<option value="linear">Linear</option>
</select>

<label>Upload Background Image</label>
<input type="file" id="editBgFile" accept="image/*">
<button type="button" id="removeImage">Remove Background Image</button>

<label>Blur</label>
<input type="range" id="editBlur" min="0" max="20">

<button id="saveEdit">Save</button>
</div>
</div>

<script>

const modal = document.getElementById('modal');
const modalText = document.getElementById('modal-text');
const closeModal = document.getElementById('closeModal');
const editorModal = document.getElementById('editorModal');

let currentElement = null;

/* -----------------------
   DRAG SYSTEM
----------------------- */

let draggedItem = null;

document.addEventListener("dragstart", e=>{
  if(e.target.classList.contains("card-item")){
    draggedItem = e.target;
  }
});

document.addEventListener("dragover", e=>{
  e.preventDefault();
});

document.addEventListener("drop", e=>{
  if(e.target.classList.contains("card-item")){
    e.target.parentNode.insertBefore(draggedItem, e.target);
  }
});

/* Make cards draggable */
function enableDrag(el){
  el.setAttribute("draggable", true);
}

/* -----------------------
   EDIT BUTTON SYSTEM
----------------------- */

function addEditButton(el){

  el.style.position = "relative";

  const editBtn = document.createElement("div");
  editBtn.classList.add("edit-btn");
  el.appendChild(editBtn);

  editBtn.addEventListener("click", (e)=>{
    e.stopPropagation();
    currentElement = el;

    const nameEl = el.querySelector(".name");

    if(nameEl){
      document.getElementById('editText').value = nameEl.textContent;
      document.getElementById('editTextSize').value =
        parseInt(getComputedStyle(nameEl).fontSize);
      document.getElementById('editTextColor').value =
        rgbToHex(getComputedStyle(nameEl).color);
    }

    editorModal.classList.add("active");
  });
}

/* Apply to existing cards */
document.querySelectorAll(".card-item").forEach(card=>{
  enableDrag(card);
  addEditButton(card);

  card.addEventListener("click", ()=>{
    modalText.textContent = card.dataset.detail;
    modal.classList.add("active");
  });
});

/* -----------------------
   ADD NEW CARD
----------------------- */

document.getElementById("addCardBtn")?.addEventListener("click", ()=>{

  const newCard = document.createElement("div");
  newCard.className = "card-item";
  newCard.innerHTML = `
    <p class="name">New Card</p>
    <p class="meta">New Info</p>
  `;

  enableDrag(newCard);
  addEditButton(newCard);

  newCard.addEventListener("click", ()=>{
    modalText.textContent = "New card popup.";
    modal.classList.add("active");
  });

  document.querySelector(".card").appendChild(newCard);
});

/* -----------------------
   REMOVE IMAGE
----------------------- */

document.getElementById("removeImage").addEventListener("click", ()=>{
  if(currentElement){
    currentElement.style.backgroundImage = "";
    document.getElementById("editBgFile").value = "";
  }
});

/* -----------------------
   SAVE EDITS
----------------------- */

document.getElementById("saveEdit").onclick = ()=>{

  if(!currentElement) return;

  const nameEl = currentElement.querySelector(".name");

  if(nameEl){
    nameEl.textContent = document.getElementById("editText").value;
    nameEl.style.color = document.getElementById("editTextColor").value;
    nameEl.style.fontSize =
      document.getElementById("editTextSize").value + "px";
  }

  const boxColor = document.getElementById("editBoxColor").value;
  const gradient = document.getElementById("gradientSelect").value;

  if(gradient==="linear"){
    currentElement.style.background =
      `linear-gradient(135deg, ${boxColor}, black)`;
  }else{
    currentElement.style.background = boxColor;
  }

  const fileInput = document.getElementById("editBgFile");

  if(fileInput.files && fileInput.files[0]){
    const reader = new FileReader();

    reader.onload = function(e){
      currentElement.style.backgroundImage =
        `url(${e.target.result})`;
      currentElement.style.backgroundSize = "cover";
      currentElement.style.backgroundPosition = "center";
    };

    reader.readAsDataURL(fileInput.files[0]);
    fileInput.value = "";
  }

  editorModal.classList.remove("active");
};

/* -----------------------
   CLOSE MODAL
----------------------- */

closeModal.onclick = ()=> modal.classList.remove("active");
modal.onclick = e=>{ if(e.target===modal) modal.classList.remove("active"); };

/* -----------------------
   COLOR HELPER
----------------------- */

function rgbToHex(rgb){
  const result = rgb.match(/\d+/g);
  return "#" + result.map(x=>{
    const hex = parseInt(x).toString(16);
    return hex.length==1 ? "0"+hex : hex;
  }).join('');
}

/* -----------------------
   MAKE PANELS EDITABLE
----------------------- */

document.querySelectorAll(".card").forEach(panel=>{
  addEditButton(panel);
});

</script>
</body>
</html>
